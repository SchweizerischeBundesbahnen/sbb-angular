@import '../../../angular/styles/common';

$datePickerContentTop: 17;

$datePickerToggleWrapperArrowHeight: pxToEm(16);
$datePickerToggleArrowWidth: 18;
$datePickerToggleArrowHeight: pxToEm(2);
$datePickerToggleArrowColor: $sbbColorGrey;
$datePickerToggleArrowAfterOffset: pxToEm(9);

$datePickerCalendarBorderWidth: 2;
$datePickerCalendarBorder: pxToEm($datePickerCalendarBorderWidth) solid $sbbColorGrey;
$datePickerCalendarBg: $sbbColorWhite;
$datePickerCalendarHeaderColor: $sbbColorMetal;
$datePickerCalendarWidthMobile: pxToEm(340);
$datePickerCalendarHeightMobile: pxToEm(380);
$datePickerCalendarWidth: pxToEm(428);
$datePickerCalendarHeight: pxToEm(428);
$datepickerCalendarLineColor: $sbbColorPlatinum;

$datePickerCalendarBorderRadius: pxToEm(2);
$datePickerCalendarHeaderHeight: 68;
$datePickerCalendarHeaderLabelFontSize: 21;
$datePickerCalendarHeaderLabelLineHeight: 3.2;

$datePickerCalendarTableContentPaddingWidth: 18;
$datePickerCalendarTableTodayFontFamily: $fontSbbBold;
$datePickerCalendarTableTodayColor: $sbbColorBlack;
$datePickerCalendarTableActiveColor: $sbbColorRed125;
$datePickerCalendarTableSelectedColor: $sbbColorGrey;
$datePickerCalendarTableRangeBgColor: $sbbColorMilk;

$datePickerCalendarDisabledCellColor: $sbbColorCement;
$datePickerCalendarDisabledTextCellColor: $sbbColorCement;
$datePickerDisabledCellWidth: 32;
$datePickerDisabledCellTop: 20;
$datePickerDisabledCellLeft: 18;

// start of lean variables
$datePickerContentTopLean: 8;

$datePickerCalendarBorderLean: pxToEm(1) solid $sbbColorIron;
$datepickerCalendarLineColorLean: $sbbColorCloud;

$datePickerCalendarWidthMobileLean: pxToEm(303);
$datePickerCalendarHeightMobileLean: pxToEm(303);

$datePickerCalendarWidthLean: pxToEm(303);
$datePickerCalendarHeightLean: pxToEm(303);

$datePickerCalendarHeaderHeightLean: 36;
$datePickerCalendarHeaderLabelFontSizeLean: 15;
$datePickerCalendarHeaderLabelLineHeightLean: pxToEm(36);
$datePickerCalendarHeaderColorLean: $sbbColorIron;

$datePickerCalendarTableContentPaddingWidthLean: 16;
$datePickerCalendarTableSelectedColorLean: $sbbColorIron;

$datePickerToggleArrowWidthLean: 9;
$datePickerToggleArrowColorLean: $sbbColorIron;
$datePickerToggleArrowAfterOffsetLean: pxToEm($datePickerToggleArrowWidthLean / 2);

$datePickerCalendarDisabledCellColorLean: $sbbColorStorm;
$datePickerCalendarDisabledTextCellColorLean: $sbbColorStorm;
$datePickerDisabledCellWidthLean: 24;
$datePickerDisabledCellTopLean: 17;
$datePickerDisabledCellLeftLean: 12;
// end of lean variables

$datePickerToggleArrowTopOffset: -($datePickerToggleWrapperArrowHeight -
      $datePickerToggleArrowHeight);

@mixin datePickerCellContentBase() {
  position: absolute;
  top: 12.5%;
  left: 12.5%;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 72%;
  height: 81%;
  html:not(.sbb-lean) & {
    @include mq($from: tabletPortrait) {
      height: 84%;
    }
  }
  line-height: 1;
  padding-left: pxToEm(1);
  padding-bottom: pxToEm(1);
}

.sbb-datepicker-content {
  position: relative;
  width: 100%;
  top: pxToEm($datePickerContentTop);
  font-size: pxToRem($sizeFontDefault);

  html:not(.sbb-lean) & {
    @include mq($from: desktop4k) {
      font-size: pxToRem($sizeFontDefault4k);
    }
    @include mq($from: desktop5k) {
      font-size: pxToRem($sizeFontDefault5k);
    }
  }

  html.sbb-lean & {
    top: pxToEm($datePickerContentTopLean);
  }

  .sbb-datepicker-panel-above & {
    top: auto;
    bottom: pxToEm($datePickerContentTop);

    html.sbb-lean & {
      top: auto; // Redefine to be specific enough
      bottom: pxToEm($datePickerContentTopLean);
    }
  }

  // Arrow
  &:after {
    top: pxToEm(-8);
    left: pxToEm(14);
    content: '';
    height: pxToEm(20);
    width: pxToEm(20);
    position: absolute;
    pointer-events: none;
    transform: rotate(-135deg);
    background-color: $sbbColorWhite;
    border: pxToEm(2) solid transparent;
    border-right-color: $datePickerToggleArrowColor;
    border-bottom-color: $datePickerToggleArrowColor;

    html.sbb-lean & {
      top: pxToEm(-4);
      left: pxToEm(12);
      border-width: pxToEm(1);
      width: pxToEm(10);
      height: pxToEm(10);
      border-right-color: $datePickerToggleArrowColorLean;
      border-bottom-color: $datePickerToggleArrowColorLean;
    }

    .sbb-datepicker-with-arrows & {
      left: pxToEm(42);

      html.sbb-lean & {
        left: pxToEm(36);
      }
    }

    .sbb-datepicker-panel-above & {
      top: auto;
      bottom: pxToEm(-8);
      transform: rotate(45deg);

      html.sbb-lean & {
        top: auto;
        bottom: pxToEm(-4);
      }
    }
  }
}

.sbb-calendar {
  display: block;
  width: $datePickerCalendarWidthMobile;
  max-width: 100%;
  height: $datePickerCalendarHeightMobile;
  background-color: $datePickerCalendarBg;
  border: $datePickerCalendarBorder;
  border-radius: $datePickerCalendarBorderRadius;
  box-shadow: boxShadowEm(1, $datePickerCalendarBorderWidth, 1);

  html.sbb-lean & {
    border: $datePickerCalendarBorderLean;
    width: $datePickerCalendarWidthMobileLean;
    height: $datePickerCalendarHeightMobileLean;
    box-shadow: boxShadowEm(1, 1, 1);
  }

  @include mq($from: tabletPortrait) {
    width: $datePickerCalendarWidth;
    height: $datePickerCalendarHeight;

    html.sbb-lean & {
      width: $datePickerCalendarWidthLean;
      height: $datePickerCalendarHeightLean;
    }
  }
}

.sbb-calendar-header {
  display: block;
  border-bottom: pxToRem(1) solid $datepickerCalendarLineColor;

  html:not(.sbb-lean) & {
    @include mq($from: desktop4k) {
      border-bottom-width: pxToRem(1 * $scalingFactor4k);
    }

    @include mq($from: desktop5k) {
      border-bottom-width: pxToRem(1 * $scalingFactor5k);
    }
  }

  html.sbb-lean & {
    border-bottom-color: $datepickerCalendarLineColorLean;
  }
}

.sbb-calendar-controls {
  display: flex;
  height: pxToEm($datePickerCalendarHeaderHeight);
  align-items: center;

  html.sbb-lean & {
    height: pxToEm($datePickerCalendarHeaderHeightLean);
  }
}

.sbb-calendar-controls-months,
.sbb-calendar-controls-years {
  height: pxToEm($datePickerCalendarHeaderHeight);
  flex: 1 0 50%;
  text-align: center;
  position: relative;

  html.sbb-lean & {
    height: pxToEm($datePickerCalendarHeaderHeightLean);
  }
}

.sbb-calendar-controls-months {
  &::after {
    content: '';
    display: block;
    position: absolute;
    width: 0;
    height: 100%;
    top: 0;
    right: 0;
    border-right: pxToRem(1) solid $datepickerCalendarLineColor;

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        border-right-width: pxToRem(1 * $scalingFactor4k);
      }

      @include mq($from: desktop5k) {
        border-right-width: pxToRem(1 * $scalingFactor5k);
      }
    }

    html.sbb-lean & {
      border-right-color: $datepickerCalendarLineColorLean;
    }
  }
}

.sbb-calender-controls-button {
  @include buttonResetFrameless();

  display: flex;
  align-items: center;
  justify-content: center;
  outline: 0;
  width: pxToEm(40);
  height: pxToEm($datePickerCalendarHeaderHeight);
  vertical-align: middle;
  cursor: pointer;
  color: $datePickerCalendarHeaderColor;

  &:hover,
  &:focus,
  &:active {
    color: $datePickerCalendarTableActiveColor;
  }

  &:disabled {
    cursor: default;
    opacity: 0;
  }

  html:not(.sbb-lean) & {
    @include mq($to: tabletPortrait) {
      width: pxToEm(24);
    }
  }

  html.sbb-lean & {
    height: pxToEm($datePickerCalendarHeaderHeightLean);
    color: $datePickerCalendarHeaderColorLean;
  }
}

.sbb-calender-controls-button-previous {
  float: left;
}

.sbb-calender-controls-button-next {
  float: right;
}

.sbb-calendar-controls-label {
  font-family: $fontSbbLight;
  font-size: pxToEm($datePickerCalendarHeaderLabelFontSize);
  line-height: $datePickerCalendarHeaderLabelLineHeight;
  color: $datePickerCalendarHeaderColor;

  html.sbb-lean & {
    font-size: pxToEm($datePickerCalendarHeaderLabelFontSizeLean);
    line-height: $datePickerCalendarHeaderLabelLineHeightLean;
    color: $datePickerCalendarHeaderColorLean;
  }
}

.sbb-calendar-content {
  padding: 0 pxToEm(11) pxToEm(0) pxToEm(11);

  @include mq($from: tabletPortrait) {
    padding: 0 pxToEm($datePickerCalendarTableContentPaddingWidth) pxToEm(0)
      pxToEm($datePickerCalendarTableContentPaddingWidth);

    html.sbb-lean & {
      padding: 0 pxToEm($datePickerCalendarTableContentPaddingWidthLean)
        pxToEm($datePickerCalendarTableContentPaddingWidthLean)
        pxToEm($datePickerCalendarTableContentPaddingWidthLean);
    }
  }
}

.sbb-calendar-table {
  width: 100%;
  border-spacing: 0;
  border-collapse: collapse;
  margin: 0;
  position: relative;

  td,
  th {
    color: $sbbColorGrey;

    html.sbb-lean & {
      color: $sbbColorIron;
    }
  }
}

.sbb-calendar-table-header {
  &::after {
    content: '';
    display: block;
    position: absolute;
    top: pxToEm(33);

    width: calc(100% + #{pxToEm(2 * 11)});
    left: pxToEm(-11);
    @include mq($from: tabletPortrait) {
      width: calc(100% + #{pxToEm(2 * $datePickerCalendarTableContentPaddingWidth)});
      left: pxToEm(-$datePickerCalendarTableContentPaddingWidth);

      html.sbb-lean & {
        width: calc(100% + #{pxToEm(2 * $datePickerCalendarTableContentPaddingWidthLean)});
        left: pxToEm(-$datePickerCalendarTableContentPaddingWidthLean);
      }
    }

    border-bottom: pxToRem(1) solid $datepickerCalendarLineColor;

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        border-bottom-width: pxToRem(1 * $scalingFactor4k);
      }

      @include mq($from: desktop5k) {
        border-bottom-width: pxToRem(1 * $scalingFactor5k);
      }
    }

    html.sbb-lean & {
      border-bottom-color: $datepickerCalendarLineColorLean;
    }
  }

  tr th {
    font-family: $fontSbbRoman;
    font-weight: 400;
    font-size: pxToEm(13);
    text-transform: uppercase;
    padding: pxToEm(7, 13);
    color: $datePickerCalendarHeaderColor;

    html.sbb-lean & {
      color: $datePickerCalendarHeaderColorLean;
    }
  }
}

.sbb-calendar-table-header-divider {
  height: pxToEm(15);
}

// TODO: Check from here and ensure no pxToEm or similar is in a variable, inline into code, collision of indicator arrow in 5k with lowest circle

.sbb-calendar-body-cell {
  position: relative;
  height: 0;
  line-height: 0;
  text-align: center;
  outline: 0;
  cursor: pointer;

  &:not(.sbb-calendar-body-disabled):hover,
  &:not(.sbb-calendar-body-disabled):focus {
    .sbb-calendar-body-cell-content {
      color: $datePickerCalendarTableActiveColor;
      border-color: $datePickerCalendarTableActiveColor;
    }
  }

  &.sbb-calendar-body-range-background,
  &.sbb-calendar-body-selected-begin,
  &.sbb-calendar-body-selected-end {
    &::before {
      content: '';
      background-color: $datePickerCalendarTableRangeBgColor;
      @include datePickerCellContentBase();
      width: 100%;
      left: 0;
    }
  }

  &.sbb-calendar-body-selected-begin,
  &.sbb-calendar-body-selected-end {
    &::before {
      width: 50%;
    }
  }

  &.sbb-calendar-body-selected-begin {
    &::before {
      left: auto;
      right: 0;
    }
  }

  &:not(.sbb-calendar-body-disabled).sbb-calendar-body-selected,
  &.sbb-calendar-body-selected-begin,
  &.sbb-calendar-body-selected-end {
    .sbb-calendar-body-cell-content {
      background-color: $datePickerCalendarBg;
      color: $datePickerCalendarTableSelectedColor;
      border-color: $datePickerCalendarTableSelectedColor;

      html.sbb-lean & {
        color: $datePickerCalendarTableSelectedColorLean;
        border-color: $datePickerCalendarTableSelectedColorLean;
      }
    }
  }

  &.sbb-calendar-body-today {
    font-family: $datePickerCalendarTableTodayFontFamily;
    color: $datePickerCalendarTableTodayColor;
  }

  &.sbb-calendar-body-disabled {
    color: $datePickerCalendarDisabledTextCellColor;
    cursor: default;

    html.sbb-lean & {
      color: $datePickerCalendarDisabledTextCellColorLean;
    }

    &:not(.empty)::after {
      content: '';
      width: pxToEm($datePickerDisabledCellWidth);
      height: pxToEm(1);
      top: pxToEm($datePickerDisabledCellTop);
      left: calc(50% - #{pxToEm($datePickerDisabledCellLeft)});
      background-color: $datePickerCalendarDisabledCellColor;
      display: block;
      position: absolute;
      transform: rotate(-45deg);

      html.sbb-lean & {
        background-color: $datePickerCalendarDisabledCellColorLean;
        width: pxToEm($datePickerDisabledCellWidthLean);
        top: pxToEm($datePickerDisabledCellTopLean);
        left: calc(50% - #{pxToEm($datePickerDisabledCellLeftLean)});
      }

      html:not(.sbb-lean) & {
        @include mq($from: tabletPortrait) {
          top: pxToEm(26);
        }
      }
    }
  }

  .sbb-calendar-body-cell-content {
    border-color: transparent;
    border-width: pxToEm(2);
    border-style: solid;
    border-radius: 50%;
    @include datePickerCellContentBase();
  }
}
