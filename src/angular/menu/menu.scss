@import '../../angular/styles/common';

$borderWidthStandard: 2;
$borderWidthLean: 1;

// Prevent rendering sbb-menu as it can affect the flex layout.
sbb-menu {
  display: none;
}

.sbb-menu-panel {
  border-top-style: solid;
  border-radius: pxToRem(2);
  max-height: calc(100vh - #{pxToRem(24)});
  outline: 0;
  width: pxToRem(216);

  // Give the menu a minimum height so that the user can't
  // collapse it to zero when they scroll away.
  min-height: pxToRem(48);

  // Prevent users from interacting with the panel while it's animating. Note that
  // people won't be able to click through it, because the overlay pane will catch the click.
  // This fixes the following issues:
  //  * Users accidentally opening sub-menus when the `overlapTrigger` option is enabled.
  //  * Users accidentally tapping on content inside the sub-menu on touch devices, if the
  //    sub-menu overlaps the trigger. The issue is due to touch devices emulating the
  //    `mouseenter` event by dispatching it on tap.
  &.ng-animating {
    pointer-events: none;
  }

  box-shadow: boxShadow(1, $borderWidthStandard, 1);
  border-top-width: pxToRem($borderWidthStandard);

  html:not(.sbb-lean) & {
    @include mq($from: desktop4k) {
      width: pxToRem(216 * $scalingFactor4k);
      box-shadow: boxShadow(1, $borderWidthStandard, $scalingFactor4k);
      border-top-width: pxToRem($borderWidthStandard * $scalingFactor4k);
    }
    @include mq($from: desktop5k) {
      width: pxToRem(216 * $scalingFactor5k);
      box-shadow: boxShadow(1, $borderWidthStandard, $scalingFactor5k);
      border-top-width: pxToRem($borderWidthStandard * $scalingFactor5k);
    }
  }

  html.sbb-lean & {
    box-shadow: boxShadow(1, $borderWidthLean, 1);
    border-top-width: pxToRem($borderWidthLean);
  }
}

.sbb-menu-mask {
  display: none;
  position: absolute;
  height: pxToRem($borderWidthStandard);
  background-color: $sbbColorWhite;

  // TODO: find better solution for position static selector
  .sbb-menu-panel-variant-standard[style*='position: static'] .sbb-menu-panel-root & {
    display: block;
  }

  html:not(.sbb-lean) & {
    @include mq($from: desktop4k) {
      height: pxToRem($borderWidthStandard * $scalingFactor4k);
    }
    @include mq($from: desktop5k) {
      height: pxToRem($borderWidthStandard * $scalingFactor5k);
    }
  }

  html.sbb-lean & {
    height: pxToRem($borderWidthLean);
  }

  .sbb-menu-below & {
    top: pxToRem(-$borderWidthStandard);

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        top: pxToRem(-$borderWidthStandard * $scalingFactor4k);
      }
      @include mq($from: desktop5k) {
        top: pxToRem(-$borderWidthStandard * $scalingFactor5k);
      }
    }
    html.sbb-lean & {
      top: pxToRem(-$borderWidthLean);
    }
  }

  .sbb-menu-above & {
    bottom: pxToRem(-$borderWidthStandard);

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        bottom: pxToRem(-$borderWidthStandard * $scalingFactor4k);
      }
      @include mq($from: desktop5k) {
        bottom: pxToRem(-$borderWidthStandard * $scalingFactor5k);
      }
    }
    html.sbb-lean & {
      bottom: pxToRem(-$borderWidthLean);
    }
  }

  .sbb-menu-before & {
    right: 0;
  }

  .sbb-menu-after & {
    left: 0;
  }
}

.sbb-menu-panel-variant-standard .sbb-menu-panel-root {
  overflow: inherit;

  &.sbb-menu-below {
    margin-top: pxToRem(-$borderWidthStandard);

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        margin-top: pxToRem(-$borderWidthStandard * $scalingFactor4k);
      }
      @include mq($from: desktop5k) {
        margin-top: pxToRem(-$borderWidthStandard * $scalingFactor5k);
      }
    }
    html.sbb-lean & {
      margin-top: pxToRem(-$borderWidthLean);
    }
  }

  &.sbb-menu-above {
    margin-bottom: pxToRem(-$borderWidthStandard - 1);

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        margin-bottom: pxToRem((-$borderWidthStandard - 1) * $scalingFactor4k);
      }
      @include mq($from: desktop5k) {
        margin-bottom: pxToRem((-$borderWidthStandard - 1) * $scalingFactor5k);
      }
    }
    html.sbb-lean & {
      margin-bottom: pxToRem(-$borderWidthLean - 1);
    }
  }

  &.sbb-menu-before.sbb-menu-below {
    border-top-right-radius: 0;
  }
  &.sbb-menu-before.sbb-menu-above {
    border-bottom-right-radius: 0;
  }
  &.sbb-menu-after.sbb-menu-below {
    border-top-left-radius: 0;
  }
  &.sbb-menu-after.sbb-menu-above {
    border-bottom-left-radius: 0;
  }
}

.sbb-menu-item {
  position: relative;
}

button.sbb-menu-item {
  width: 100%;
}

.sbb-menu-trigger-root.sbb-menu-trigger-standard {
  display: inline-block;
  background: none;
  max-width: none;
  min-width: 0;
  border: pxToRem($borderWidthStandard) solid transparent;
  padding: pxToRem(6);
  outline: 0;
  cursor: pointer;
  color: $sbbColorBlack;
  line-height: 0;
  border-radius: pxToRem(2);

  &:hover,
  &:active,
  &:focus {
    color: $sbbColorRed125;
  }

  .sbb-icon {
    width: pxToRem(24);
    height: pxToRem(24);

    html:not(.sbb-lean) & {
      @include mq($from: desktop4k) {
        width: pxToRem(24 * $scalingFactor4k);
        height: pxToRem(24 * $scalingFactor4k);
      }

      @include mq($from: desktop5k) {
        width: pxToRem(24 * $scalingFactor5k);
        height: pxToRem(24 * $scalingFactor5k);
      }
    }
  }

  html:not(.sbb-lean) & {
    @include mq($from: desktop4k) {
      padding: pxToRem(6 * $scalingFactor4k);
      border-width: pxToRem($borderWidthStandard * $scalingFactor4k);
    }
    @include mq($from: desktop5k) {
      padding: pxToRem(6 * $scalingFactor5k);
      border-width: pxToRem($borderWidthStandard * $scalingFactor5k);
    }
  }

  html.sbb-lean & {
    border-width: pxToRem($borderWidthLean);
  }

  &.sbb-menu-trigger-open {
    border-color: $sbbColorGrey;
    background-color: $sbbColorWhite;

    html.sbb-lean & {
      border-color: $sbbColorIron;

      &.sbb-menu-trigger-position-below {
        border-bottom-color: transparent;
      }
      &.sbb-menu-trigger-position-above {
        border-top-color: transparent;
      }
    }

    &.sbb-menu-trigger-position-below {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      border-bottom-color: transparent;
    }
    &.sbb-menu-trigger-position-above {
      border-top-left-radius: 0;
      border-top-right-radius: 0;
      border-top-color: transparent;
      box-shadow: boxShadow(1, $borderWidthStandard, 1);

      html:not(.sbb-lean) & {
        @include mq($from: desktop4k) {
          box-shadow: boxShadow(1, $borderWidthStandard, $scalingFactor4k);
        }
        @include mq($from: desktop5k) {
          box-shadow: boxShadow(1, $borderWidthStandard, $scalingFactor5k);
        }
      }

      html.sbb-lean & {
        box-shadow: boxShadow(1, $borderWidthLean, 1);
      }
    }

    &:hover,
    &:active,
    &:focus {
      color: $sbbColorBlack;
    }
  }
}

.sbb-menu-item-submenu-trigger {
  // We have to overwrite typography styles
  &,
  html.sbb-lean &.sbb-menu-item {
    padding-right: pxToRem(32);
  }

  html:not(.sbb-lean) &.sbb-menu-item {
    @include mq($from: desktop4k) {
      padding-right: pxToRem(32 * $scalingFactor4k);
    }
    @include mq($from: desktop5k) {
      padding-right: pxToRem(32 * $scalingFactor5k);
    }
  }
}

.sbb-menu-item-submenu-trigger-icon {
  position: absolute;
  right: 0;
}
